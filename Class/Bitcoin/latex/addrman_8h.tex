\hypertarget{addrman_8h}{}\section{C\+:/\+Users/\+Joe/\+Documents/\+School/\+C\+S\+C17\+A/bitcoin/src/addrman.h File Reference}
\label{addrman_8h}\index{C\+:/\+Users/\+Joe/\+Documents/\+School/\+C\+S\+C17\+A/bitcoin/src/addrman.\+h@{C\+:/\+Users/\+Joe/\+Documents/\+School/\+C\+S\+C17\+A/bitcoin/src/addrman.\+h}}
{\ttfamily \#include \char`\"{}netbase.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}protocol.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}random.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}sync.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}timedata.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}util.\+h\char`\"{}}\\*
{\ttfamily \#include $<$map$>$}\\*
{\ttfamily \#include $<$set$>$}\\*
{\ttfamily \#include $<$stdint.\+h$>$}\\*
{\ttfamily \#include $<$vector$>$}\\*
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{class_c_addr_info}{C\+Addr\+Info}
\item 
class \hyperlink{class_c_addr_man}{C\+Addr\+Man}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{addrman_8h_ab09df186aa818ce7b9e7c86446511cf1}{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T}~256
\begin{DoxyCompactList}\small\item\em total number of buckets for tried addresses \end{DoxyCompactList}\item 
\#define \hyperlink{addrman_8h_a74a626eb1dbb8e307a413e86493cd510}{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T}~1024
\begin{DoxyCompactList}\small\item\em total number of buckets for new addresses \end{DoxyCompactList}\item 
\#define \hyperlink{addrman_8h_a3499731a6c89e164cf74b68be2be0a84}{A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+Z\+E}~64
\begin{DoxyCompactList}\small\item\em maximum allowed number of entries in buckets for new and tried addresses \end{DoxyCompactList}\item 
\#define \hyperlink{addrman_8h_a87c7c90e3631bf1a4475cabdded61f6f}{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+U\+P}~8
\begin{DoxyCompactList}\small\item\em over how many buckets entries with tried addresses from a single group (/16 for I\+Pv4) are spread \end{DoxyCompactList}\item 
\#define \hyperlink{addrman_8h_a09c090218fd02375aa57eb7e8eb1c013}{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+U\+P}~64
\begin{DoxyCompactList}\small\item\em over how many buckets entries with new addresses originating from a single group are spread \end{DoxyCompactList}\item 
\#define \hyperlink{addrman_8h_a230e30813119d10bdba59c1f8cc789cd}{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+S\+S}~8
\begin{DoxyCompactList}\small\item\em in how many buckets for entries with new addresses a single address may occur \end{DoxyCompactList}\item 
\#define \hyperlink{addrman_8h_a86698b159625d84b47a2ffddc76ebc99}{A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+Y\+S}~30
\begin{DoxyCompactList}\small\item\em how old addresses can maximally be \end{DoxyCompactList}\item 
\#define \hyperlink{addrman_8h_a771c05a7a20d9a35f4546e1e333c48c4}{A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+E\+S}~3
\begin{DoxyCompactList}\small\item\em after how many failed attempts we give up on a new node \end{DoxyCompactList}\item 
\#define \hyperlink{addrman_8h_a26430e6e9a3ef9f4fc54491330b7e611}{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+E\+S}~10
\begin{DoxyCompactList}\small\item\em how many successive failures are allowed ... \end{DoxyCompactList}\item 
\#define \hyperlink{addrman_8h_a7dcc28590c48ca382d26c4f37fda4e3d}{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+Y\+S}~7
\begin{DoxyCompactList}\small\item\em ... in at least this many days \end{DoxyCompactList}\item 
\#define \hyperlink{addrman_8h_a06edfd03ad361fbc74794e1c533d1bc5}{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+C\+T}~23
\begin{DoxyCompactList}\small\item\em the maximum percentage of nodes to return in a getaddr call \end{DoxyCompactList}\item 
\#define \hyperlink{addrman_8h_ad10877f29a66224fce5c20d33e26448a}{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X}~2500
\begin{DoxyCompactList}\small\item\em the maximum number of nodes to return in a getaddr call \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{addrman_8h_a3499731a6c89e164cf74b68be2be0a84}{}\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+Z\+E@{A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+Z\+E}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+Z\+E@{A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+Z\+E}!addrman.\+h@{addrman.\+h}}
\subsubsection[{A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+Z\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+Z\+E~64}\label{addrman_8h_a3499731a6c89e164cf74b68be2be0a84}


maximum allowed number of entries in buckets for new and tried addresses 

\hypertarget{addrman_8h_ad10877f29a66224fce5c20d33e26448a}{}\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X@{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X@{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X}!addrman.\+h@{addrman.\+h}}
\subsubsection[{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X~2500}\label{addrman_8h_ad10877f29a66224fce5c20d33e26448a}


the maximum number of nodes to return in a getaddr call 

\hypertarget{addrman_8h_a06edfd03ad361fbc74794e1c533d1bc5}{}\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+C\+T@{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+C\+T}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+C\+T@{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+C\+T}!addrman.\+h@{addrman.\+h}}
\subsubsection[{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+C\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+C\+T~23}\label{addrman_8h_a06edfd03ad361fbc74794e1c533d1bc5}


the maximum percentage of nodes to return in a getaddr call 

\hypertarget{addrman_8h_a86698b159625d84b47a2ffddc76ebc99}{}\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+Y\+S@{A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+Y\+S}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+Y\+S@{A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+Y\+S}!addrman.\+h@{addrman.\+h}}
\subsubsection[{A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+Y\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+Y\+S~30}\label{addrman_8h_a86698b159625d84b47a2ffddc76ebc99}


how old addresses can maximally be 

\hypertarget{addrman_8h_a26430e6e9a3ef9f4fc54491330b7e611}{}\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+E\+S@{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+E\+S}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+E\+S@{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+E\+S}!addrman.\+h@{addrman.\+h}}
\subsubsection[{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+E\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+E\+S~10}\label{addrman_8h_a26430e6e9a3ef9f4fc54491330b7e611}


how many successive failures are allowed ... 

\hypertarget{addrman_8h_a7dcc28590c48ca382d26c4f37fda4e3d}{}\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+Y\+S@{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+Y\+S}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+Y\+S@{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+Y\+S}!addrman.\+h@{addrman.\+h}}
\subsubsection[{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+Y\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+Y\+S~7}\label{addrman_8h_a7dcc28590c48ca382d26c4f37fda4e3d}


... in at least this many days 

\hypertarget{addrman_8h_a74a626eb1dbb8e307a413e86493cd510}{}\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T@{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T@{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T}!addrman.\+h@{addrman.\+h}}
\subsubsection[{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T~1024}\label{addrman_8h_a74a626eb1dbb8e307a413e86493cd510}


total number of buckets for new addresses 

\hypertarget{addrman_8h_a230e30813119d10bdba59c1f8cc789cd}{}\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+S\+S@{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+S\+S}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+S\+S@{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+S\+S}!addrman.\+h@{addrman.\+h}}
\subsubsection[{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+S\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+S\+S~8}\label{addrman_8h_a230e30813119d10bdba59c1f8cc789cd}


in how many buckets for entries with new addresses a single address may occur 

\hypertarget{addrman_8h_a09c090218fd02375aa57eb7e8eb1c013}{}\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+U\+P@{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+U\+P}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+U\+P@{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+U\+P}!addrman.\+h@{addrman.\+h}}
\subsubsection[{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+U\+P}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+U\+P~64}\label{addrman_8h_a09c090218fd02375aa57eb7e8eb1c013}


over how many buckets entries with new addresses originating from a single group are spread 

\hypertarget{addrman_8h_a771c05a7a20d9a35f4546e1e333c48c4}{}\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+E\+S@{A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+E\+S}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+E\+S@{A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+E\+S}!addrman.\+h@{addrman.\+h}}
\subsubsection[{A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+E\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+E\+S~3}\label{addrman_8h_a771c05a7a20d9a35f4546e1e333c48c4}


after how many failed attempts we give up on a new node 

\hypertarget{addrman_8h_ab09df186aa818ce7b9e7c86446511cf1}{}\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T@{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T@{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T}!addrman.\+h@{addrman.\+h}}
\subsubsection[{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+N\+T~256}\label{addrman_8h_ab09df186aa818ce7b9e7c86446511cf1}


total number of buckets for tried addresses 

Stochastic address manager

Design goals\+:
\begin{DoxyItemize}
\item Keep the address tables in-\/memory, and asynchronously dump the entire to able in peers.\+dat.
\item Make sure no (localized) attacker can fill the entire table with his nodes/addresses.
\end{DoxyItemize}

To that end\+:
\begin{DoxyItemize}
\item Addresses are organized into buckets.
\begin{DoxyItemize}
\item Address that have not yet been tried go into 1024 \char`\"{}new\char`\"{} buckets.
\begin{DoxyItemize}
\item Based on the address range (/16 for I\+Pv4) of source of the information, 64 buckets are selected at random
\item The actual bucket is chosen from one of these, based on the range the address itself is located.
\item One single address can occur in up to 8 different buckets, to increase selection chances for addresses that are seen frequently. The chance for increasing this multiplicity decreases exponentially.
\item When adding a new address to a full bucket, a randomly chosen entry (with a bias favoring less recently seen ones) is removed from it first.
\end{DoxyItemize}
\item Addresses of nodes that are known to be accessible go into 256 \char`\"{}tried\char`\"{} buckets.
\begin{DoxyItemize}
\item Each address range selects at random 8 of these buckets.
\item The actual bucket is chosen from one of these, based on the full address.
\item When adding a new good address to a full bucket, a randomly chosen entry (with a bias favoring less recently tried ones) is evicted from it, back to the \char`\"{}new\char`\"{} buckets.
\end{DoxyItemize}
\item Bucket selection is based on cryptographic hashing, using a randomly-\/generated 256-\/bit key, which should not be observable by adversaries.
\item Several indexes are kept for high performance. Defining D\+E\+B\+U\+G\+\_\+\+A\+D\+D\+R\+M\+A\+N will introduce frequent (and expensive) consistency checks for the entire data structure. 
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{addrman_8h_a87c7c90e3631bf1a4475cabdded61f6f}{}\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+U\+P@{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+U\+P}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+U\+P@{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+U\+P}!addrman.\+h@{addrman.\+h}}
\subsubsection[{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+U\+P}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+U\+P~8}\label{addrman_8h_a87c7c90e3631bf1a4475cabdded61f6f}


over how many buckets entries with tried addresses from a single group (/16 for I\+Pv4) are spread 

